<!DOCTYPE html>

<html>
<head>
        
		<script type="text/javascript">
		function copyit(theField) {
	var selectedText = document.selection;
	if (selectedText.type == 'Text') {
		var newRange = selectedText.createRange();
		theField.focus();
		theField.value = newRange.text;
	} else {
		alert('select a text in the page and then press this button');
	}
}
</script>
	var editboxHTML = 
		'<html class="expand close">' +
		'<head>' +
		'<style type="text/css">' +
		'.expand { width: 100%; height: 100%; }' +
		'.close { border: none; margin: 0px; padding: 0px; }' +
		'html,body { overflow: hidden; }' +
		'<\/style>' +
		'<\/head>' +
		'<body class="expand close" onload="document.f.ta.focus(); document.f.ta.select();">' +
		'<form class="expand close" name="f">' +
		'<textarea class="expand close" style="background: #def;" name="ta" wrap="hard" spellcheck="false">' +
		'<\/textarea>' +
		'<\/form>' +
		'<\/body>' +
		'<\/html>';
	var defaultStuff = '<h3><center>Welcome to the HTML Template Tool!</center><\/h3>\n' +
	'<p><center>Type HTML in the textarea above, and it will appear in the frame below.</center><\/p>';
	var old = '';
         
	function init()
		{
		window.editbox.document.write(editboxHTML);
		window.editbox.document.close();
		window.editbox.document.f.ta.value = defaultStuff;
		update();
		}
	function update()
	{
			var textarea = window.editbox.document.f.ta;
			var d = dynamicframe.document; 
  
				if (old != textarea.value) {
				old = textarea.value;
				d.open();
				d.write(old);
				if (old.replace(/[\r\n]/g,'') == defaultStuff.replace(/[\r\n]/g,''))
				d.close();
		}
				window.setTimeout(update, 150);
	}
</script>
</head>

<form name="it">
<div align="center">
<input onclick="copyit(this.form.select1)" type="button" value="Press to copy the highlighted text" name="btnCopy">
<p>
<textarea name="select1" rows="4" cols="45"></textarea>
</div>
</form>

<frameset resizable="yes" rows="50%,*" onload="init();">
  <!-- about:blank confuses opera, so use javascript: URLs instead -->
  <frame name="dynamicframe" src="javascript:'';">
  <frame name="editbox" src="javascript:'';">
</frameset>

</html>
